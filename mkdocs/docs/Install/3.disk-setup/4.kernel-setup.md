# Kernel Setup

Setup of the kernel files

Note the dist-kernel use flag should trigger a rebuild of kernel modules automatically
when the kernel bin is updated

## Install Default Kernel

To install the kernel bin files (default)
```bash
# Install kernel bin files
emerge sys-kernel/gentoo-kernel-bin
# Rebuild any modules
emerge --ask @module-rebuild
```

## Install 6.12

To install 6.12
```bash
echo "=sys-kernel/gentoo-kernel-bin-6.12.16" >> /etc/portage/package.accept_keywords/kernels
echo "=virtual/dist-kernel-6.12.16" >> /etc/portage/package.accept_keywords/kernels
emerge --ask @module-rebuild
```

## Install 6.13

6.13 seems to have an issue with a repeating error (patched in latest version) `kernel: EDAC igen6 MC0: HANDLING IBECC MEMORY ERROR`
```bash
echo "=sys-kernel/gentoo-kernel-bin-6.13.4" >> /etc/portage/package.accept_keywords/kernels
echo "=virtual/dist-kernel-6.13.4" >> /etc/portage/package.accept_keywords/kernels
emerge =sys-kernel/gentoo-kernel-bin-6.13.4
emerge --ask @module-rebuild
```

## Update Grub Menu

After installing a new kernel we need to refresh the grub boot menu
```bash
grub-mkconfig -o /boot/grub/grub.cfg
```

## Shoe installed versions

To show which versions are installed
```bash
eix gentoo-kernel-bin
```

## Select Kernel

To select which kernel to use
```bash
# To list available kernels
eselect kernel list
# Select a kernel
eselect kernel set 1
```

Note grub-mkconfig does not select which kernel will be used at bootup
by default grub defaults to the latest one


Within `/etc/default/grub` set GRUB_DEFAULT to the correct submenu entry
```bash
GRUB_DEFAULT=0>1
```

To lookup the grub menu entries TODO

